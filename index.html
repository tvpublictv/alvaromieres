<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alvaro Mieres</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to external CSS file -->
</head>

<body>
    <!-- LOADING SCREEN -->
    <div id="loading-screen">
        <div class="loading-container">
            <h1>alvaro mieres</h1>
        </div>
        <div class="loading-bar">
            <div class="loading-fill" id="loading-fill"></div>
        </div>
    </div>

    <!-- MAIN PAGE -->
    <div id="content" class="hidden">
        
        <div class="scrollable-content"></div>

        <!-- Header -->
        <header>
            
            <!-- Date -->
            <div class="date-display" id="dateDisplay">
                <div class="year" id="yearDisplay"></div>
                <div class="month" id="monthDisplay"></div>
            </div>
            
            <!-- Index -->
            <ul class="pill-box">
                <li class="pill pill1">architecture</li>
                <li class="pill pill2">research</li>
                <li class="pill pill3">other</li>
                <li class="pill pill4">visual</li>
                <li class="pill pill5">art</li>
            </ul>
        </header>

        <!-- Elipse mask overlay -->
        <div class="gradient-overlay"></div>

        <!-- Circle Pattern -->
        <div id="circle-pattern" class="circle"></div>
    </div>

    <!-- JavaScript for shadow effect and date display -->
    <script>
        const circle = document.querySelector('.circle');

        document.addEventListener('mousemove', (event) => {
            const mouseX = event.clientX;
            const mouseY = event.clientY;

            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;

            const deltaX = -(mouseX - centerX) / window.innerWidth;
            const deltaY = -(mouseY - centerY) / window.innerHeight;

            const offset = `min(0.2vw, 0.2vh)`;
            const shadowOffsetX = `calc(${offset} * ${deltaX * 5})`;
            const shadowOffsetY = `calc(${offset} * ${deltaY * 5})`;

            circle.style.filter = `drop-shadow(${shadowOffsetX} ${shadowOffsetY} calc(${offset} * 0.5) #595959)`;
        });
    </script>

    <!-- Loading Script -->
    <script>
        
        //Loading bar animation
        function animateLoadingBar() {
            const fill = document.getElementById('loading-fill');

            setTimeout(() => {
                fill.style.transitionDuration = '1500';
                fill.style.width = '100%';
            }, 250);
        }

        window.onload = function () {
            
            // Center the viewport horizontally
            const centerX = (document.body.scrollWidth - window.innerWidth) / 2;
            window.scrollTo(centerX, 0);
            
            animateLoadingBar();

            setTimeout(function () {
                document.getElementById('loading-screen').classList.add('fade-out');

                setTimeout(function () {
                    document.getElementById('loading-screen').style.display = 'none';
                    document.getElementById('content').classList.remove('hidden');
                    document.querySelector('header').style.display = 'block';
                    
                    
                    
                }, 1000);
            }, 2000);
            
            setTimeout(function () {
                
                const patternSize = document.getElementById('circle-pattern');
                    patternSize.style.width = '110vw';  // Change width
                    patternSize.style.height = '500vh'; //hay que poner 100 mas
                    patternSize.style.left = '-5vw';
                
            }, 4000);
        };
        
       
        // Reset scroll position before the page is unloaded (for refresh)
        window.onbeforeunload = function() {
            const centerX = (document.body.scrollWidth - window.innerWidth) / 2;
            window.scrollTo(centerX, 0);
        }

        
        const yearDisplay = document.getElementById('yearDisplay');
        const monthDisplay = document.getElementById('monthDisplay');
        const startYear = 2024;
        const startMonthIndex = 7;

        function updateDate() {
            const scrollY = window.scrollY;
            const totalScrollHeight = document.body.scrollHeight - window.innerHeight;
            const totalMonths = Math.floor((scrollY / totalScrollHeight) * 80);
            const monthIndex = (startMonthIndex - totalMonths + 12) % 12;
            const currentYear = startYear - Math.floor(totalMonths / 12);

            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];

            if (currentYear < 2018) {
                return;
            }

            yearDisplay.innerHTML = currentYear;
            monthDisplay.innerHTML = monthNames[monthIndex];
        }

        window.addEventListener('scroll', updateDate);

        let isDragging = false;
        let startY, startX;
        let scrollSpeedY = 0;
        let scrollSpeedX = 0;
        let targetScrollSpeedY = 0;
        let targetScrollSpeedX = 0;
        const acceleration = 0.05;
        const deceleration = 0.95;

        function mouseDown(e) {
            isDragging = true;
            startY = e.clientY;
            startX = e.clientX;
            document.body.style.cursor = 'grabbing';
        }

        function mouseUp() {
            isDragging = false;
            document.body.style.cursor = 'default';
        }

        function mouseMove(e) {
            if (!isDragging) return;

            const deltaY = startY - e.clientY;
            const deltaX = startX - e.clientX;
            startY = e.clientY;
            startX = e.clientX;

            targetScrollSpeedY = deltaY * 0.5;
            targetScrollSpeedX = deltaX * 0.5;
        }

        function smoothScroll() {
            if (isDragging) {
                scrollSpeedY += (targetScrollSpeedY - scrollSpeedY) * acceleration;
                scrollSpeedX += (targetScrollSpeedX - scrollSpeedX) * acceleration;
                window.scrollBy(scrollSpeedX, scrollSpeedY);
            } else {
                scrollSpeedY *= deceleration;
                scrollSpeedX *= deceleration;
                window.scrollBy(scrollSpeedX, scrollSpeedY);
            }

            requestAnimationFrame(smoothScroll);
        }

        window.addEventListener('mousedown', mouseDown);
        window.addEventListener('mouseup', mouseUp);
        window.addEventListener('mousemove', mouseMove);

        smoothScroll();
        updateDate();
    </script>
</body>

</html>
